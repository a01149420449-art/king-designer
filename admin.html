<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>King Admin | ğŸ‘‘ Ù…Ø±ÙƒØ² Ø§Ù„ØªØ­ÙƒÙ…</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700;900&display=swap" rel="stylesheet">
    <style>
        :root { --red: #ff3b30; --blue: #0071e3; --green: #34c759; --purple: #5856d6; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Cairo', sans-serif; }
        body { display: flex; height: 100vh; background: #f5f5f7; }
        .sidebar { width: 120px; background: #1d1d1f; display: flex; flex-direction: column; align-items: center; padding: 20px 0; gap: 20px; border-radius: 0 30px 30px 0; }
        .app-icon { width: 80px; height: 80px; border-radius: 20px; cursor: pointer; color: white; border: none; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.3s; }
        .app-icon span { font-size: 10px; margin-top: 5px; font-weight: bold; }
        .active-app { border: 3px solid white; transform: scale(1.1); }
        .content { flex: 1; padding: 30px; overflow-y: auto; }
        .screen { display: none; } .active { display: block; }
        .card { background: white; padding: 25px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .chat-box { display: flex; height: 500px; background: #e5ddd5; border-radius: 25px; overflow: hidden; }
        .u-list { width: 30%; background: white; overflow-y: auto; border-left: 1px solid #eee; }
        .u-item { padding: 15px; border-bottom: 1px solid #eee; cursor: pointer; font-weight: bold; }
        .msgs { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .bubble { padding: 12px; border-radius: 15px; max-width: 80%; }
        .bubble.admin { background: #dcf8c6; align-self: flex-end; }
        .bubble.user { background: #fff; align-self: flex-start; }
        input, select { width: 100%; padding: 15px; border-radius: 15px; border: 1px solid #ddd; margin-bottom: 10px; outline: none; }
        .btn { padding: 15px; border-radius: 15px; border: none; cursor: pointer; font-weight: 900; color: white; width: 100%; transition: 0.3s; }
        .btn:active { transform: scale(0.95); }
    </style>
</head>
<body>

<div class="sidebar">
    <button class="app-icon active-app" style="background:var(--green);" onclick="openApp('chats', this)">ğŸ’¬<span>ÙˆØ§ØªØ³Ø§Ø¨</span></button>
    <button class="app-icon" style="background:var(--purple);" onclick="openApp('codes', this)">ğŸŸï¸<span>Ø£ÙƒÙˆØ§Ø¯ÙŠ</span></button>
    <button class="app-icon" style="background:var(--blue);" onclick="openApp('updates', this)">ğŸš€<span>ØªØ­Ø¯ÙŠØ«Ø§ØªÙŠ</span></button>
    <button class="app-icon" style="background:var(--red);" onclick="openApp('bandy', this)">ğŸš«<span>Ø¨Ø§Ù†Ø¯ÙŠ</span></button>
</div>

<div class="content">
    <div id="chats" class="screen active">
        <h1>ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ù…Ù„Ùƒ ğŸŸ¢</h1>
        <div class="chat-box">
            <div class="u-list" id="user-list"></div>
            <div style="flex:1; display:flex; flex-direction:column;">
                <div class="msgs" id="msg-area"></div>
                <div style="padding:15px; background:white; border-top:1px solid #eee;">
                    <button class="btn" style="background:var(--purple); margin-bottom:10px;" onclick="sendWelcome()">âœ¨ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ±Ø­ÙŠØ¨ ÙˆØ§Ù„Ø¯ÙØ¹</button>
                    <div style="display:flex; gap:10px;">
                        <input type="text" id="reply-inp" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..." style="margin:0;">
                        <button class="btn" style="background:var(--green); width:100px; margin:0;" onclick="reply()">Ø¥Ø±Ø³Ø§Ù„</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="codes" class="screen">
        <h1>ØªØ·Ø¨ÙŠÙ‚ "Ø£ÙƒÙˆØ§Ø¯ÙŠ" ğŸŸï¸</h1>
        <div class="card">
            <label>Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…ÙŠÙ„:</label>
            <select id="code-user-select"></select>
            <input type="text" id="mail-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙƒÙˆØ¯ (Ù…Ø«Ù„Ø§Ù‹: ÙƒÙˆØ¯ Ø§Ù„Ù„ÙˆØ¬Ùˆ)">
            <input type="text" id="mail-content" placeholder="Ø±Ù…Ø² Ø§Ù„ÙƒÙˆØ¯">
            <button class="btn" style="background:var(--purple);" onclick="sendToMail()">Ø¥Ø±Ø³Ø§Ù„ Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„ âœ…</button>
        </div>
    </div>

    <div id="updates" class="screen">
        <h1>ØªØ·Ø¨ÙŠÙ‚ "ØªØ­Ø¯ÙŠØ«Ø§ØªÙŠ" ğŸš€</h1>
        <div class="card">
            <input type="text" id="up-msg" placeholder="Ù…Ø§ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ­Ø¯ÙŠØ«ØŸ">
            <button class="btn" style="background:var(--blue);" onclick="pushUpdate()">Ø¥Ø±Ø³Ø§Ù„ Ø²Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙÙˆØ±ÙŠ Ù„Ù„ÙƒÙ„ ğŸ“¢</button>
        </div>
    </div>

    <div id="bandy" class="screen">
        <h1>Ù†Ø¸Ø§Ù… "Ø¨Ø§Ù†Ø¯ÙŠ" ğŸš«</h1>
        <div class="card" style="border: 2px solid var(--red);">
            <h3>Ø·Ø±Ø¯ Ø¹Ù…ÙŠÙ„ Ù…Ù† Ø§Ù„Ù…Ù…Ù„ÙƒØ©</h3>
            <select id="ban-user-select"></select>
            <button class="btn" style="background:var(--red);" onclick="applyBan()">Ø¥Ø¹Ø·Ø§Ø¡ Ø¨Ø§Ù†Ø¯ Ù†Ù‡Ø§Ø¦ÙŠ ğŸ’€</button>
        </div>
        <div class="card">
            <h3>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø·Ø±ÙˆØ¯ÙŠÙ† Ø­Ø§Ù„ÙŠØ§Ù‹:</h3>
            <div id="banned-list-area"></div>
        </div>
    </div>
</div>

<script>
    let curUser = "";
    const welcomeMsg = "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ù…Ù„Ùƒ! ğŸ‘‘\nÙ„Ù„Ø¯ÙØ¹ ÙˆØªØ¬Ù‡ÙŠØ² Ø·Ù„Ø¨Ùƒ:\nğŸ“± ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´: 01061104228\nğŸ’¸ Ø¥Ù†Ø³ØªØ§ Ø¨Ø§ÙŠ: 01061104228\nØ§Ø±Ø³Ù„ ØµÙˆØ±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ù‡Ù†Ø§!";

    function openApp(id, btn) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.app-icon').forEach(i => i.classList.remove('active-app'));
        btn.classList.add('active-app');
        refresh();
    }

    function refresh() {
        const users = [];
        const banned = JSON.parse(localStorage.getItem('banned_users')) || [];
        for (let i=0; i<localStorage.length; i++) {
            if(localStorage.key(i).startsWith('chat_')) users.push(localStorage.key(i).replace('chat_', ''));
        }
        
        document.getElementById('user-list').innerHTML = users.map(u => `<div class="u-item" onclick="openChat('${u}')">ğŸ‘¤ ${u}</div>`).join('');
        const selects = ['code-user-select', 'ban-user-select'];
        selects.forEach(s => document.getElementById(s).innerHTML = users.map(u => `<option value="${u}">${u}</option>`).join(''));

        document.getElementById('banned-list-area').innerHTML = banned.map(b => `
            <div style="display:flex; justify-content:space-between; padding:10px; background:#fff1f1; border-radius:10px; margin-bottom:5px; border:1px solid red;">
                <b style="color:red;">ğŸš« ${b}</b>
                <button onclick="unban('${b}')" style="background:green; color:white; border:none; padding:5px 10px; border-radius:8px; cursor:pointer;">ÙÙƒ Ø§Ù„Ø¨Ø§Ù†Ø¯</button>
            </div>
        `).join('');
    }

    function openChat(u) {
        curUser = u;
        const chat = JSON.parse(localStorage.getItem(`chat_${u}`)) || [];
        document.getElementById('msg-area').innerHTML = chat.map(m => `<div class="bubble ${m.role}">${m.text}</div>`).join('');
        document.getElementById('msg-area').scrollTop = 9999;
    }

    function reply() {
        const t = document.getElementById('reply-inp').value;
        if(!t || !curUser) return;
        let chat = JSON.parse(localStorage.getItem(`chat_${curUser}`)) || [];
        chat.push({role:'admin', text:t});
        localStorage.setItem(`chat_${curUser}`, JSON.stringify(chat));
        document.getElementById('reply-inp').value = ""; openChat(curUser);
    }

    function sendWelcome() { if(curUser) { 
        let chat = JSON.parse(localStorage.getItem(`chat_${curUser}`)) || [];
        chat.push({role:'admin', text:welcomeMsg});
        localStorage.setItem(`chat_${curUser}`, JSON.stringify(chat));
        openChat(curUser);
    }}

    function sendToMail() {
        const u = document.getElementById('code-user-select').value;
        let mails = JSON.parse(localStorage.getItem(`mails_${u}`)) || [];
        mails.push({title: document.getElementById('mail-title').value, code: document.getElementById('mail-content').value});
        localStorage.setItem(`mails_${u}`, JSON.stringify(mails));
        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¹Ù…ÙŠÙ„!");
    }

    function pushUpdate() {
        const m = document.getElementById('up-msg').value;
        for (let i=0; i<localStorage.length; i++) {
            if(localStorage.key(i).startsWith('chat_')) {
                let u = localStorage.key(i).replace('chat_', '');
                let mails = JSON.parse(localStorage.getItem(`mails_${u}`)) || [];
                mails.push({title: m, type: 'REFRESH'});
                localStorage.setItem(`mails_${u}`, JSON.stringify(mails));
            }
        }
        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ« Ù„Ù„Ø¬Ù…ÙŠØ¹!");
    }

    function applyBan() {
        const u = document.getElementById('ban-user-select').value;
        let banned = JSON.parse(localStorage.getItem('banned_users')) || [];
        if(!banned.includes(u)) banned.push(u);
        localStorage.setItem('banned_users', JSON.stringify(banned));
        refresh();
    }

    function unban(u) {
        let banned = JSON.parse(localStorage.getItem('banned_users')) || [];
        localStorage.setItem('banned_users', JSON.stringify(banned.filter(x => x !== u)));
        refresh();
    }

    setInterval(refresh, 3000); refresh();
</script>
</body>
</html>